<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Augmented implementation of linear discriminant analysis — lda-ord • ordr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Augmented implementation of linear discriminant analysis — lda-ord" />
<meta property="og:description" content="This function replicates MASS::lda() with options to retain
elements useful to the tbl_ord class and biplot calculations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ordr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Augmented implementation of linear discriminant analysis</h1>
    
    <div class="hidden name"><code>lda-ord.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function replicates <code><a href='https://rdrr.io/pkg/MASS/man/lda.html'>MASS::lda()</a></code> with options to retain
elements useful to the <a href='tbl_ord.html'>tbl_ord</a> class and biplot calculations.</p>
    </div>

    <pre class="usage"><span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for formula</span>
<span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>data</span>, <span class='va'>...</span>, <span class='va'>subset</span>, <span class='va'>na.action</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>grouping</span>, <span class='va'>...</span>, <span class='va'>subset</span>, <span class='va'>na.action</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>lda_ord</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>grouping</span>,
  prior <span class='op'>=</span> <span class='va'>proportions</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-04</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"moment"</span>, <span class='st'>"mle"</span>, <span class='st'>"mve"</span>, <span class='st'>"t"</span><span class='op'>)</span>,
  CV <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nu <span class='op'>=</span> <span class='fl'>5</span>,
  <span class='va'>...</span>,
  ret.x <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ret.grouping <span class='op'>=</span> <span class='cn'>FALSE</span>,
  axes.scale <span class='op'>=</span> <span class='st'>"unstandardized"</span>
<span class='op'>)</span>

<span class='co'># S3 method for lda_ord</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>newdata</span>,
  prior <span class='op'>=</span> <span class='va'>object</span><span class='op'>$</span><span class='va'>prior</span>,
  <span class='va'>dimen</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"plug-in"</span>, <span class='st'>"predictive"</span>, <span class='st'>"debiased"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>(required if no formula is given as the principal argument.)
    a matrix or data frame or Matrix containing the explanatory variables.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to or from other methods.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula of the form <code>groups ~ x1 + x2 + ...</code>  That is, the
    response is the grouping factor and the right hand side specifies
    the (non-factor) discriminators.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An optional data frame, list or environment from which variables
    specified in <code>formula</code> are preferentially to be taken.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An index vector specifying the cases to be used in the training
    sample.  (NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>A function to specify the action to be taken if <code>NA</code>s are found.
    The default action is for the procedure to fail.  An alternative is
    <code>na.omit</code>, which leads to rejection of cases with missing values on
    any required variable.  (NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>grouping</th>
      <td><p>(required if no formula principal argument is given.)
    a factor specifying the class for each observation.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>the prior probabilities of class membership.  If unspecified, the
    class proportions for the training set are used.  If present, the
    probabilities should be specified in the order of the factor
    levels.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>A tolerance to decide if a matrix is singular; it will reject variables
    and linear combinations of unit-variance variables whose variance is
    less than <code>tol^2</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code>"moment"</code> for standard estimators of the mean and variance,
    <code>"mle"</code> for MLEs, <code>"mve"</code> to use <code><a href='https://rdrr.io/pkg/MASS/man/cov.rob.html'>cov.mve</a></code>, or
    <code>"t"</code> for robust estimates based on a \(t\) distribution.</p></td>
    </tr>
    <tr>
      <th>CV</th>
      <td><p>If true, returns results (classes and posterior probabilities) for
    leave-one-out cross-validation. Note that if the prior is estimated,
    the proportions in the whole dataset are used.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>degrees of freedom for <code>method = "t"</code>.</p></td>
    </tr>
    <tr>
      <th>ret.x, ret.grouping</th>
      <td><p>Logical; whether to retain as attributes the data
matrix (<code>x</code>) and the class assignments (<code>grouping</code>) on which LDA is
performed. Methods like <code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code> access these objects by name in the
parent environment, and retaining them as attributes prevents errors that
arise if these objects are reassigned.</p></td>
    </tr>
    <tr>
      <th>axes.scale</th>
      <td><p>Character string indicating how to left-transform the
<code>scaling</code> value when rendering biplots using <code><a href='ggbiplot.html'>ggbiplot()</a></code>. Options include
<code>"unstandardized"</code>, <code>"standardized"</code>, and <code>"contribution"</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>object  of class <code>"lda"</code></p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>data frame of cases to be classified or, if <code>object</code>
  has a formula, a data frame with columns of the same names as the
  variables used.  A vector will be interpreted
  as a row vector.  If newdata is missing, an attempt will be
  made to retrieve the data used to fit the <code>lda</code> object.</p></td>
    </tr>
    <tr>
      <th>dimen</th>
      <td><p>the dimension of the space to be used. If this is less than <code><a href='https://rdrr.io/r/base/Extremes.html'>min(p, ng-1)</a></code>,
only the first <code>dimen</code> discriminant components are used (except for
<code>method="predictive"</code>), and only those dimensions are returned in <code>x</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Linear discriminant analysis relies on an eigendecomposition of the product
\(W^{-1}B\) of the inverse of the within-class covariance matrix \(W\) by
the between-class covariance matrix \(B\). This eigendecomposition can be
motivated as the right (\(V\)) half of the singular value decomposition of
the matrix of <em>Mahalanobis distances</em> between the cases after "sphering"
(linearly transforming them so that the within-class covariance is the
identity matrix). LDA are not traditionally represented as biplots, with some
exceptions (Gardner &amp; le Roux, 2005; Greenacre, 2010, p. 109--117).</p>
<p>LDA is implemented as <code><a href='https://rdrr.io/pkg/MASS/man/lda.html'>MASS::lda()</a></code> in the <strong>MASS</strong> package, in which the
variables are transformed by a sphering matrix \(S\) (Venables &amp; Ripley,
2003, p. 331--333). The returned element <code>scaling</code> contains the
unstandardized <em>discriminant coefficients</em>, which define the discriminant
scores of the cases and their centroids as linear combinations of the
original variables.</p>
<p>The discriminant coefficients constitute one of several possible choices of
axes for a biplot representation of the LDA. The slightly modified function
<code>lda_ord()</code> provides additional options:</p><ul>
<li><p>The <em>standardized discriminant coefficients</em> are obtained by (re)scaling
the coefficients by the variable standard deviations. These coefficients
indicate the contributions of the variables to the discriminant scores after
controlling for their variances (ttnphns, 2013).</p></li>
<li><p>The variables' <em>contributions</em> to the Mahalanobis variance along each
discriminant axis are obtained by transforming the coefficients by the
inverse of the sphering matrix \(S\). Because the contribution biplot
derives from the eigendecomposition of the Mahalanobis distance matrix, the
projections of the centroids and cases onto the variable axes approximate
their variable values after centering and sphering (Greenacre, 2013).</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gardner S &amp; le Roux NJ (2005) "Extensions of Biplot Methodology to
Discriminant Analysis". <em>Journal of Classification</em> <strong>22</strong>(1): 59--86.
doi: <a href='https://doi.org/10.1007/s00357-005-0006-7'>10.1007/s00357-005-0006-7</a>

<a href='https://link.springer.com/article/10.1007/s00357-005-0006-7'>https://link.springer.com/article/10.1007/s00357-005-0006-7</a></p>
<p>Greenacre MJ (2010) <em>Biplots in Practice</em>. Fundacion BBVA, ISBN:
978-84-923846.
<a href='https://www.fbbva.es/microsite/multivariate-statistics/biplots.html'>https://www.fbbva.es/microsite/multivariate-statistics/biplots.html</a></p>
<p>Venables WN &amp; Ripley BD (2003) <em>Modern Applied Statistics with S</em>, Fourth
Edition. Springer Science &amp; Business Media, ISBN: 0387954570, 9780387954578.
<a href='http://www.bagualu.net/wordpress/wp-content/uploads/2015/10/Modern_Applied_Statistics_With_S.pdf'>http://www.bagualu.net/wordpress/wp-content/uploads/2015/10/Modern_Applied_Statistics_With_S.pdf</a></p>
<p>ttnphns (2013) <em>Answer to</em> "Algebra of LDA. Fisher discrimination power of a
variable and Linear Discriminant Analysis". CrossValidated, accessed
2019-07-26. <a href='https://stats.stackexchange.com/a/83114/68743'>https://stats.stackexchange.com/a/83114/68743</a></p>
<p>Greenacre M (2013) "Contribution Biplots". <em>Journal of Computational and
Graphical Statistics</em>, <strong>22</strong>(1): 107--122.
<a href='https://amstat.tandfonline.com/doi/full/10.1080/10618600.2012.702494'>https://amstat.tandfonline.com/doi/full/10.1080/10618600.2012.702494</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Linear discriminant analysis of Reaven &amp; Miller diabetes data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>heplots</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/heplots/man/Diabetes.html'>Diabetes</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt;   relwt glufast glutest instest sspg  group
#&gt; 1  0.81      80     356     124   55 Normal
#&gt; 2  0.95      97     289     117   76 Normal
#&gt; 3  0.94     105     319     143  105 Normal
#&gt; 4  1.04      90     356     199  108 Normal
#&gt; 5  1.00      90     323     240  143 Normal
#&gt; 6  0.76      86     381     157  165 Normal</div><div class='input'><span class='va'>diabetes_lda</span> <span class='op'>&lt;-</span> <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lda.html'>lda</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='fu'>heplots</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/heplots/man/Diabetes.html'>Diabetes</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>diabetes_lda</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call:
#&gt; lda(group ~ ., data = heplots::Diabetes)
#&gt; 
#&gt; Prior probabilities of groups:
#&gt;            Normal Chemical_Diabetic    Overt_Diabetic 
#&gt;         0.5241379         0.2482759         0.2275862 
#&gt; 
#&gt; Group means:
#&gt;                       relwt   glufast   glutest  instest     sspg
#&gt; Normal            0.9372368  91.18421  349.9737 172.6447 114.0000
#&gt; Chemical_Diabetic 1.0558333  99.30556  493.9444 288.0000 208.9722
#&gt; Overt_Diabetic    0.9839394 217.66667 1043.7576 106.0000 318.8788
#&gt; 
#&gt; Coefficients of linear discriminants:
#&gt;                   LD1          LD2
#&gt; relwt    1.3624356881 -3.784142444
#&gt; glufast -0.0336487883  0.036633317
#&gt; glutest  0.0125763942 -0.007092017
#&gt; instest -0.0001022245 -0.006173424
#&gt; sspg     0.0042431866  0.001134070
#&gt; 
#&gt; Proportion of trace:
#&gt;    LD1    LD2 
#&gt; 0.8812 0.1188 </div><div class='input'><span class='fu'><a href='tbl_ord.html'>as_tbl_ord</a></span><span class='op'>(</span><span class='va'>diabetes_lda</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://generics.r-lib.org/reference/augment.html'>augment</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='dplyr-verbs.html'>mutate_rows</a></span><span class='op'>(</span>discriminant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span> <span class='va'>.supplement</span>, <span class='st'>"centroid"</span>, <span class='st'>"case"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>diabetes_lda</span>
</div><div class='output co'>#&gt; # A tbl_ord of class 'lda': (148 x 2) x (5 x 2)'
#&gt; # 2 coordinates: LD1 and LD2
#&gt; # 
#&gt; # Rows: [ 148 x 2 | 6 ]
#&gt;      LD1    LD2 |   .name .prior .counts .grouping
#&gt;                 |   <span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #949494;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>    
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> -</span><span style='color: #BB0000;'>1.75</span><span>   0.400 | </span><span style='color: #BCBCBC;'>1</span><span> Norm…  0.524      76 Normal   
#&gt; </span><span style='color: #BCBCBC;'>2</span><span>  0.340 -</span><span style='color: #BB0000;'>1.38</span><span>  | </span><span style='color: #BCBCBC;'>2</span><span> Chem…  0.248      36 Chemical…
#&gt; </span><span style='color: #BCBCBC;'>3</span><span>  3.66   0.580 | </span><span style='color: #BCBCBC;'>3</span><span> Over…  0.228      33 Overt_Di…
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> -</span><span style='color: #BB0000;'>1.72</span><span>   0.663 | </span><span style='color: #BCBCBC;'>4</span><span> 1     </span><span style='color: #BB0000;'>NA</span><span>          </span><span style='color: #BB0000;'>NA</span><span> Normal   
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> -</span><span style='color: #BB0000;'>2.85</span><span>   1.30  | </span><span style='color: #BCBCBC;'>5</span><span> 2     </span><span style='color: #BB0000;'>NA</span><span>          </span><span style='color: #BB0000;'>NA</span><span> Normal   
#&gt; </span><span style='color: #949494;'># … with 143 more rows, and 2 more</span><span>
#&gt; # Rows: [ 148 x 2 | 6 ]</span><span style='color: #949494;'>#   variables: .supplement </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span style='color: #949494;'>,</span><span>
#&gt;      LD1    LD2 | </span><span style='color: #949494;'>#   discriminant </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>
#&gt; # 
#&gt; # Columns: [ 5 x 2 | 1 ]
#&gt;         LD1      LD2 |   .name  
#&gt;                      |   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>  
#&gt; </span><span style='color: #BCBCBC;'>1</span><span>  1.36     -</span><span style='color: #BB0000;'>3.78</span><span>    | </span><span style='color: #BCBCBC;'>1</span><span> relwt  
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> -</span><span style='color: #BB0000;'>0.033</span><span style='color: #BB0000;text-decoration: underline;'>6</span><span>    0.036</span><span style='text-decoration: underline;'>6</span><span>  | </span><span style='color: #BCBCBC;'>2</span><span> glufast
#&gt; </span><span style='color: #BCBCBC;'>3</span><span>  0.012</span><span style='text-decoration: underline;'>6</span><span>   -</span><span style='color: #BB0000;'>0.007</span><span style='color: #BB0000;text-decoration: underline;'>09</span><span> | </span><span style='color: #BCBCBC;'>3</span><span> glutest
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> -</span><span style='color: #BB0000;'>0.000</span><span style='color: #BB0000;text-decoration: underline;'>102</span><span> -</span><span style='color: #BB0000;'>0.006</span><span style='color: #BB0000;text-decoration: underline;'>17</span><span> | </span><span style='color: #BCBCBC;'>4</span><span> instest
#&gt; </span><span style='color: #BCBCBC;'>5</span><span>  0.004</span><span style='text-decoration: underline;'>24</span><span>   0.001</span><span style='text-decoration: underline;'>13</span><span> | </span><span style='color: #BCBCBC;'>5</span><span> sspg   </div><div class='input'><span class='fu'><a href='ggbiplot.html'>ggbiplot</a></span><span class='op'>(</span><span class='va'>diabetes_lda</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='geom-biplot-point.html'>geom_rows_point</a></span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>shape <span class='op'>=</span> <span class='va'>.grouping</span>, size <span class='op'>=</span> <span class='va'>discriminant</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='geom-biplot-axis.html'>geom_cols_axis</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#888888"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Column-standardized LDA biplot of Reaven &amp; Miller diabetes data"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Using size for a discrete variable is not advised.</span></div><div class='img'><img src='lda-ord-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Unstandardized, standardized, and de-sphered LDAs of Anderson Iris data</span>
<span class='co'># data centroid</span>
<span class='va'>iris_centroid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># custom biplot</span>
<span class='va'>lda_biplot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>lda</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>lda</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='tbl_ord.html'>as_tbl_ord</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://generics.r-lib.org/reference/augment.html'>augment</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='dplyr-verbs.html'>mutate_rows</a></span><span class='op'>(</span>
      species <span class='op'>=</span> <span class='va'>.grouping</span>,
      discriminant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span> <span class='va'>.supplement</span>, <span class='st'>"centroid"</span>, <span class='st'>"case"</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='ggbiplot.html'>ggbiplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='geom-biplot-point.html'>geom_rows_point</a></span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>
      color <span class='op'>=</span> <span class='va'>.grouping</span>,
      size <span class='op'>=</span> <span class='va'>discriminant</span>, alpha <span class='op'>=</span> <span class='va'>discriminant</span>
    <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='geom-biplot-vector.html'>geom_cols_vector</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#888888"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='geom-biplot-text-radiate.html'>geom_cols_text_radiate</a></span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>.name</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>scale_color_brewer</span><span class='op'>(</span>type <span class='op'>=</span> <span class='st'>"qual"</span>, palette <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Unstandardized discriminant coefficients define the discriminant axes as</span>
<span class='co'># linear combinations of the centered variables</span>
<span class='va'>iris_lda</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='tbl_ord.html'>as_tbl_ord</a></span><span class='op'>(</span><span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>5</span><span class='op'>]</span>, axes.scale <span class='op'>=</span> <span class='st'>"unstandardized"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># linear combinations of centered variables</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sweep.html'>sweep</a></span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>$</span><span class='va'>means</span>, <span class='fl'>2</span>, <span class='va'>iris_centroid</span>, <span class='st'>"-"</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='accessors.html'>get_cols</a></span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  LD1        LD2
#&gt; setosa      7.607600  0.2151330
#&gt; versicolor -1.825049 -0.7278996
#&gt; virginica  -5.782550  0.5127666</div><div class='input'><span class='co'># discriminant centroids</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='accessors.html'>get_rows</a></span><span class='op'>(</span><span class='va'>iris_lda</span>, .supplement <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  LD1        LD2
#&gt; setosa      7.607600  0.2151330
#&gt; versicolor -1.825049 -0.7278996
#&gt; virginica  -5.782550  0.5127666</div><div class='input'><span class='co'># unstandardized coefficient LDA biplot</span>
<span class='fu'>lda_biplot</span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Unstandardized coefficient biplot of iris LDA"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>expand_limits</span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Using size for a discrete variable is not advised.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Using alpha for a discrete variable is not advised.</span></div><div class='img'><img src='lda-ord-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Standardized discriminant coefficients permit comparisons across the variables</span>
<span class='va'>iris_lda</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='tbl_ord.html'>as_tbl_ord</a></span><span class='op'>(</span><span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>5</span><span class='op'>]</span>, axes.scale <span class='op'>=</span> <span class='st'>"standardized"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># standardized variable contributions to discriminant axes</span>
<span class='fu'><a href='fortify.html'>fortify</a></span><span class='op'>(</span><span class='va'>iris_lda</span>, .matrix <span class='op'>=</span> <span class='st'>"cols"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>variable <span class='op'>=</span> <span class='va'>.name</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span><span class='op'>(</span><span class='va'>discriminant</span>, <span class='va'>coefficient</span>, <span class='va'>LD1</span>, <span class='va'>LD2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>discriminant</span>, y <span class='op'>=</span> <span class='va'>coefficient</span>, fill <span class='op'>=</span> <span class='va'>variable</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span>position <span class='op'>=</span> <span class='st'>"dodge"</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='st'>"Standardized coefficient"</span>, x <span class='op'>=</span> <span class='st'>"Linear discriminant"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>coord_flip</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='lda-ord-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># standardized coefficient LDA biplot</span>
<span class='fu'>lda_biplot</span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Standardized coefficient biplot of iris LDA"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>expand_limits</span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Using size for a discrete variable is not advised.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Using alpha for a discrete variable is not advised.</span></div><div class='img'><img src='lda-ord-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Variable contributions (de-sphered discriminant coefficients) recover the</span>
<span class='co'># inner product relationship with the centered class centroids</span>
<span class='va'>iris_lda</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='tbl_ord.html'>as_tbl_ord</a></span><span class='op'>(</span><span class='fu'>lda_ord</span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>5</span><span class='op'>]</span>, axes.scale <span class='op'>=</span> <span class='st'>"contribution"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># symmetric square root of within-class covariance</span>
<span class='va'>C_W_eig</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>iris_lda</span><span class='op'>$</span><span class='va'>means</span><span class='op'>[</span><span class='va'>iris</span><span class='op'>[</span>, <span class='fl'>5</span><span class='op'>]</span>, <span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>C_W_sqrtinv</span> <span class='op'>&lt;-</span>
  <span class='va'>C_W_eig</span><span class='op'>$</span><span class='va'>vectors</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>C_W_eig</span><span class='op'>$</span><span class='va'>values</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>C_W_eig</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>)</span>
<span class='co'># product of matrix factors (scores and loadings)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='accessors.html'>get_rows</a></span><span class='op'>(</span><span class='va'>iris_lda</span>, .supplement <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='accessors.html'>get_cols</a></span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  [,1]      [,2]      [,3]       [,4]
#&gt; setosa      0.3061785  2.593874 -5.861269 -3.9959956
#&gt; versicolor -0.1774657 -1.154286  1.457859  0.5653316
#&gt; virginica  -0.1287128 -1.439587  4.403411  3.4306640</div><div class='input'><span class='co'># "asymmetric" square roots of Mahalanobis distances between variables</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sweep.html'>sweep</a></span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>$</span><span class='va'>means</span>, <span class='fl'>2</span>, <span class='va'>iris_centroid</span>, <span class='st'>"-"</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='va'>C_W_sqrtinv</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  [,1]      [,2]      [,3]       [,4]
#&gt; setosa      0.3103442  2.629165 -5.941014 -4.0503629
#&gt; versicolor -0.1798802 -1.169991  1.477693  0.5730232
#&gt; virginica  -0.1304640 -1.459174  4.463321  3.4773397</div><div class='input'><span class='co'># contribution LDA biplot</span>
<span class='fu'>lda_biplot</span><span class='op'>(</span><span class='va'>iris_lda</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Contribution biplot of iris LDA"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>expand_limits</span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Using size for a discrete variable is not advised.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Using alpha for a discrete variable is not advised.</span></div><div class='img'><img src='lda-ord-5.png' alt='' width='700' height='433' /></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jason Cory Brunson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


